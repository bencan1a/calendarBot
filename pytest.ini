[pytest]
# Optimized pytest configuration for CalendarBot test suite
# Designed to work with standard pytest commands and prevent hanging issues

minversion = 6.0
addopts =
    --strict-markers
    --strict-config
    --tb=short
    --maxfail=10
    --durations=10
    --disable-warnings

# CRITICAL: Sequential execution only - NO parallel processing
# This prevents asyncio conflicts and hanging issues
# DO NOT ADD: -n auto, -n <number>, --dist, or any xdist options

# Test discovery paths
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Async support with proper event loop handling
asyncio_mode = auto

# Timeout settings - designed to prevent hanging tests
timeout = 120
timeout_method = thread
timeout_func_only = true

# Test categorization markers for standard pytest usage
markers =
    unit: Fast unit tests for individual components
    integration: Integration tests for component interactions
    browser: Browser automation tests with timeout protection
    e2e: End-to-end tests for complete workflows
    fast: Quick-executing tests (< 10s)
    slow: Tests that take longer than 30 seconds
    critical_path: Essential tests for core functionality
    smoke: Basic functionality verification tests
    network: Tests requiring network access (should be mocked)
    isolated: Tests requiring complete isolation
    performance: Performance and load testing
    security: Security validation and vulnerability testing

# Warning filters to reduce noise and prevent hanging
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:urllib3.*
    ignore::UserWarning:coverage.*
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore::ResourceWarning
    ignore::RuntimeWarning:asyncio.*
    ignore::DeprecationWarning:pyppeteer.*
    ignore::DeprecationWarning:websockets.*

# Required plugins for reliable execution
required_plugins =
    pytest-cov
    pytest-asyncio
    pytest-timeout

# Collection settings optimized for reliable test discovery
# Note: Most filtering handled by testpaths and python_files settings above
