[pytest]
# Sequential execution pytest configuration for stability and reliability
minversion = 6.0
addopts =
    --strict-markers
    --strict-config
    --tb=short
    --verbose
    --maxfail=5
    --durations=10
    --disable-warnings
    --capture=no
    --log-level=INFO

# CRITICAL: Sequential execution only - NO parallel processing
# This prevents asyncio conflicts and hanging issues
# DO NOT ADD: -n auto, -n <number>, --dist, or any xdist options

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Async support - auto mode with proper event loop handling
asyncio_mode = auto

# Test execution timeout settings
timeout = 120
timeout_method = thread
timeout_func_only = true

# Enhanced test markers for better categorization
markers =
    unit: Fast unit tests for individual components (< 5s)
    integration: Integration tests for component interactions (< 30s)
    e2e: End-to-end tests for complete workflows (< 60s)
    critical_path: Essential tests for core functionality
    smoke: Basic functionality verification tests
    slow: Tests that take longer than 30 seconds
    network: Tests requiring network access (should be mocked)
    browser: Browser automation tests with memory management
    security: Security-focused tests
    performance: Performance and load tests
    accessibility: Accessibility compliance tests
    coverage: Coverage validation tests
    regression: Full regression testing
    targeted: Tests selected based on code changes
    fast: Quick-executing tests (< 10s)
    isolated: Tests requiring complete isolation
    sequential: Tests that must run sequentially (no parallel)

# Warning filters to reduce test noise
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:urllib3.*
    ignore::UserWarning:coverage.*
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore::ResourceWarning
    ignore::RuntimeWarning:asyncio.*

# Test collection optimization (removed invalid config)
# Files to ignore: setup.py debug_*.py test_*_temp.py *_backup.py

# Minimum test execution requirements
required_plugins =
    pytest-cov
    pytest-asyncio
    pytest-timeout
